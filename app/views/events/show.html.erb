<%= render 'layouts/topbar' %>
<div class="container mx-auto flex justify-between p-4">
  <div>Welcome, <%= current_user.email if current_user %></div>
  <div class="flex flex-row align-middle">
    <% unless current_user %>
      <% location = session[:guest_location] || cookies[:guest_location] %>
      <% if location.present? %>
        <p class="text-lg font-semibold">Your current location: <span class="text-blue-600"><%= location %></span></p>
      <% else %>
        <p class="text-red-600">No location set.</p>
      <% end %>
      <%= button_to "Change Location", guest_location_path, method: :delete, class: "btn btn-ghost text-red-600", data: { turbo_confirm: "Are you sure you want to reset your location?" } %>
    <% end %>
  </div>
</div>
<div class="container mx-auto px-4">
  <div class="flex flex-1 flex-row gap-x-8">
    <!-- Left Column: Navigation -->
    <aside class="order-first min-w-[220px] bg-blue-100 p-4">
      <%= render "layouts/sidebar_nav" %>
    </aside>
    <!-- Main Column -->
    <main class="flex-1 bg-blue-50 p-4">
      <div class="max-w-2xl mx-auto space-y-6">
        <% if @event.image.attached? %>
  <div class="mb-4">
    <%= image_tag @event.image.variant(resize_to_limit: [800, 600]), class: "rounded-xl shadow" %>
  </div>
<% end %>
        <% if @event.category.present? %>
            <%= category_badge(@event.category) %>
        <% end %>
        <h1 class="text-2xl font-bold"><%= @event.title %></h1>
        <p class="text-gray-600">
          <strong>Start:</strong> <%= l(@event.starts_at, format: :long) %><br>
          <strong>End:</strong> <%= l(@event.ends_at, format: :long) %>
        </p>
        <div class="prose">
          <%= simple_format(@event.description) %>
        </div>
        <div class="flex gap-4">
          <%= link_to "Edit", edit_event_path(@event), class: "text-blue-600 hover:underline" %>
          <%= link_to "Back", events_path, class: "text-gray-600 hover:underline" %>
        </div>
      </div>
    </main>
  </div>
</div>