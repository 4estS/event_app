<%= render 'layouts/topbar' %>
<div class="container mx-auto flex justify-between p-4">
  <div>Welcome, <%= current_user.email if current_user %></div>
  <div class="flex flex-row align-middle">
    <% unless current_user %>
      <% location = session[:guest_location] || cookies[:guest_location] %>
      <% if location.present? %>
        <p class="text-lg font-semibold">Your current location: <span class="text-blue-600"><%= location %></span></p>
      <% else %>
        <p class="text-red-600">No location set.</p>
      <% end %>
      <%= button_to "Change Location", guest_location_path, method: :delete, class: "btn btn-ghost text-red-600", data: { turbo_confirm: "Are you sure you want to reset your location?" } %>
    <% end %>
  </div>
</div>
<div class="container mx-auto px-4">
  <div class="flex flex-1 flex-row gap-x-8">
    <!-- Left Column: Navigation -->
    <aside class="order-first min-w-[220px] bg-blue-100 p-4">
      <%= render "layouts/sidebar_nav" %>
    </aside>
    <!-- Center Column: Feed -->
    <main class="flex-1 bg-blue-50 p-4">
      <h1 class="font-bold text-4xl">Pages#home</h1>
      <p>Find me in app/views/pages/home.html.erb</p>
      <div class="flex-1 gap-x-4">
        <% @events.each do |event| %>
          <div class="border border-gray-200 p-4 rounded shadow-sm mb-4">
            <h2 class="text-lg font-semibold">
              <%= link_to event.title, event_path(event), class: "hover:underline" %>
            </h2>
            <p class="mt-2 text-gray-700"><%= truncate(event.description, length: 100) %></p>
            <p class="mt-2 text-gray-700"><%= event.location_name %></p>
            <p class="mt-2 text-gray-700"><%= event.location %></p>
          </div>
        <% end %>
      </div>
    </main>
    <!-- Right Column: Trending/Info -->
    <aside class="min-w-[340px] bg-blue-100 p-4">
      <h2 class="text-lg font-semibold mb-2">Trending</h2>
      <ul class="list-disc list-inside text-sm text-gray-700">
        <li>#rails</li>
        <li>#hotwire</li>
        <li>#tailwind</li>
      </ul>
    </aside>
  </div>
</div>
